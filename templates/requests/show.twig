{% extends "layouts/master.twig" %}

{% block title %}Request{% endblock %}

{% block content %}

    <h1>Origin</h1>

    <div class="panel panel-default">
        <div class="panel-body">
            <p>Subject: <b>{{ request.subject_name }}</b></p>
            <p>Code: <b>{{ request.subject_code }}</b></p>
            <p>Degree: <b>{{ request.degree_name }}</b></p>
            <p>Centre: <b>{{ request.centre_name }}</b></p>
            <p>University: <b>{{ request.university_name }}</b></p>
            <p>Mobility type: <b>{{ request.mobility_type }}</b></p>
        </div>
    </div>

    <h1>Destination</h1>

    {% for destination in request.destination_subjects %}
        <div class="panel panel-default">
            <div class="panel-body">
                <p>Subject: <b>{{ destination.subject_name }}</b></p>
                <p>Code: <b>{{ destination.subject_code }}</b></p>
                <p>Centre: <b>{{ destination.centre_name }}</b></p>
            </div>
        </div>
    {% endfor %}

    <h4>Comments</h4>

    {% if flash.getMessage('error') %}
        <div class="alert alert-danger" role="alert">
            {{ flash.getMessage('error')[0] }}:
            {{ flash.getMessage('messages')[0] }}
        </div>
    {% endif %}

    <form method="POST" action="{{ request.id }}/comment">
        <textarea class="form-control" rows="4" id="comment" name="comment" placeholder="Your comment ..."></textarea>
        <br>
        <input type="submit" value="Send">
    </form>

    <br>

    {% for comment in comments %}
        <div class="panel panel-default">
            <div class="panel-body">
                <p><b>{{ comment.user_name }} {{ comment.user_surname }}</b> said:</p>
                <blockquote>{{ comment.content }}</blockquote>
                <p>on {{ comment.created_at }}</p>
            </div>
        </div>
    {% endfor %}

{% endblock %}

{% block javascripts %}
    <script>
        $(function () {
            $('form').submit(function (e) {
                return $('#comment').val().length > 0 &&
                        confirm("Are you sure ?");
            });
        });
    </script>
{% endblock %}